"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7380],{7380:(ee,F,c)=>{c.r(F),c.d(F,{LoginPageModule:()=>k});var L=c(6814),g=c(95),b=c(7852),w=c(594),p=c(5861),i=c(9468),x=c(4648),P=c(7098),S=c(553),y=c(9862),M=c(4352),Z=c(93),U=c(9360),G=c(4829),I=c(2306),A=c(8251),Y=c(7103);const J=(0,I.d)(r=>function(e=null){r(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e});function D(r){throw new J(r)}var R=c(9397),$=c(4716),E=c(9882),j=c(5057);let z=(()=>{class r{constructor(e,t,n,o){this.http=e,this.globalService=t,this.storageService=n,this.authService=o,this.isFetchingUnits=!1,this.isFetchingCommodities=!1,this.REQUEST_TIMEOUT=25e3,this.apiUrl=S.N.apiUrl}makeBaseHeader(){return{headers:new y.WM({Accept:"application/json","Content-type":"application/json",Key:S.N.backOfficeKey})}}makeAuthenticatedHeader(){var e=this;return(0,p.Z)(function*(){const t=yield e.storageService.reStorage("token");return{headers:new y.WM({Accept:"application/json","Content-type":"application/json",token:`${t}`,Key:S.N.backOfficeKey})}})()}makeHttpPostRequest(e,t,n=!0,o=1,s=""){var a=this;return(0,p.Z)(function*(){const l=a.apiUrl;n&&a.globalService.showLoading();const h=yield a.makeAuthenticatedHeader(),m=a.getRequestObservable(o,l,e,t,h,s);return new Promise((f,d)=>{m.pipe(function N(r,u){const{first:e,each:t,with:n=D,scheduler:o=(null!=u?u:M.z),meta:s=null}=(0,Z.q)(r)?{first:r}:"number"==typeof r?{each:r}:r;if(null==e&&null==t)throw new TypeError("No timeout provided.");return(0,U.e)((a,l)=>{let h,m,f=null,d=0;const v=T=>{m=(0,Y.f)(l,o,()=>{try{h.unsubscribe(),(0,G.Xf)(n({meta:s,lastValue:f,seen:d})).subscribe(l)}catch(_){l.error(_)}},T)};h=a.subscribe((0,A.x)(l,T=>{null==m||m.unsubscribe(),d++,l.next(f=T),t>0&&v(t)},void 0,void 0,()=>{null!=m&&m.closed||null==m||m.unsubscribe(),f=null})),!d&&v(null!=e?"number"==typeof e?e:+e-o.now():t)})}(a.REQUEST_TIMEOUT),(0,R.b)({error:v=>{console.log(v),401===v.status&&(a.authService.removeSession(),a.globalService.showToast(v.error.msg?v.error.msg:"Please login again","danger"))}}),(0,$.x)(()=>{a.globalService.hideLoading()})).subscribe({next:H.bind(a,f),error:C.bind(a,d)})})})()}getRequestObservable(e,t,n,o,s,a){switch(e){case 2:return this.http.patch(`${t}${n}`,JSON.stringify(o),s);case 3:return this.http.get(`${t}${n}${a}`,s);case 4:return s.body=JSON.stringify(o),this.http.delete(`${t}${n}`,s);default:return this.http.post(`${t}${n}`,JSON.stringify(o),s)}}login(e){return this.makeHttpPostRequest("backoffice/login",e)}}return r.\u0275fac=function(e){return new(e||r)(i.LFG(y.eN),i.LFG(E.U),i.LFG(j.V),i.LFG(P.e))},r.\u0275prov=i.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function C(r,u){return O.apply(this,arguments)}function O(){return(O=(0,p.Z)(function*(r,u){r(u)})).apply(this,arguments)}function H(r,u){r(u)}let B=(()=>{class r{constructor(e){this.globalService=e}fieldChange(e,t,n){const o=n.split("."),s=o.pop();if(!s)return;let a=o.join(".");const l=this.getDeepObject(t,a),h=this.getDeepObject(t,n);if(e.invalid&&e.touched){const m=this.getDeepObject(t,n).label,f=this.formatErrorMessage(m,e.errors);Object.defineProperty(l,s,{value:{...h,msg:f},writable:!0})}e.valid&&Object.defineProperty(l,s,{value:{...h,msg:""},writable:!0})}validateForm(e,t,n=0,o=""){const{controls:s}=e;Object.keys(s).forEach(a=>{if(console.log(a),s[a].invalid&&!s[a].controls){let l=a;o&&(l=o+"."+a);const h=this.getDeepObject(t,l).label,m=this.formatErrorMessage(h,s[a].errors),f=this.getDeepObject(t,o),d=this.getDeepObject(t,l);Object.defineProperty(f,a,{value:{...d,msg:m},writable:!0})}else Object.defineProperty(t,a,{value:{...t[a],msg:""},writable:!0});if(s[a].controls){let l=a;o&&(l=o+"."+a),this.validateForm(s[a],t,n+1,l)}})}resetForm(e,t){e.reset(),t&&this.resetLabel(t)}resetLabel(e){e&&Object.keys(e).forEach(t=>{Object.defineProperty(e,t,{value:{...e[t],msg:""},writable:!0})})}resetErrors(e){Object.keys(e).forEach(t=>{Object.keys(e[t]).filter(o=>["label","msg"].includes(o)).length?Object.defineProperty(e,t,{value:{...e[t],msg:""},writable:!0}):e[t]&&this.resetErrors(e[t])})}getFirstError(e,t=""){let n="";return t||(Object.keys(e).forEach(o=>{var s;if(n)return n;null!==(s=e[o])&&void 0!==s&&s.msg?n=e[o].msg:e[o].length&&e[o].forEach((a,l)=>{n=this.getFirstError(e[o][l],n)})}),n)}serverErrorValidate(e,t){Object.keys(e).forEach(n=>{const o=n.split("."),s=o.pop();if(!s)return;let a=o.join(".");const l=this.getDeepObject(t,a),h=this.getDeepObject(t,n);Object.defineProperty(l,s,{value:{...h,msg:e[n]},writable:!0})})}formatErrorMessage(e,t){return e=this.globalService.translate(e),t.required?this.globalService.translate("t_form_error_required",{field_name:e}):t.minlength?this.globalService.translate("t_form_error_min_length",{actual_length:t.minlength.actualLength,min_length:t.minlength.requiredLength}):t.maxlength?this.globalService.translate("t_form_error_max_length",{actual_length:t.maxlength.actualLength,max_length:t.maxlength.requiredLength}):t.email?this.globalService.translate("t_form_error_email"):t.min?this.globalService.translate("t_form_error_min",{actual_value:t.min.actual,min_value:t.min.min}):t.max?this.globalService.translate("t_form_error_max",{actual_value:t.max.actual,max_value:t.max.max}):t.pattern?this.globalService.translate("t_form_error_pattern",{field_name:e}):t.passwordMismatch?this.globalService.translate("t_form_error_password_mismatch",{field_name:e}):t.emailInUse?this.globalService.translate("t_form_error_email_used"):t.confirmUnmatch?this.globalService.translate("t_form_error_confirm_mismatch"):""}getDeepObject(e,t){if(!t)return e;for(var o=t.split("."),s=0,a=o.length-1;s<a;s++){var l=e[o[s]];if(void 0===l)break;e=l}return e[o[s]]}}return r.\u0275fac=function(e){return new(e||r)(i.LFG(E.U))},r.\u0275prov=i.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),Q=(()=>{class r{constructor(e){this.formBuilder=e,this.loginForm=(new g.qu).group({email:[null,[g.kI.required,g.kI.pattern("[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,3}$")]],password:[null,[g.kI.required,g.kI.minLength(8)]]})}}return r.\u0275fac=function(e){return new(e||r)(i.LFG(g.qu))},r.\u0275prov=i.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var V=c(1339);function K(r,u){if(1&r&&(i.TgZ(0,"p"),i._uU(1),i.qZA()),2&r){const e=i.oxw();i.xp6(1),i.hij(" ",e.errorMsg," ")}}const W=[{path:"",component:(()=>{class r{constructor(e,t,n,o,s,a,l,h){this.navigationService=e,this.formBuilder=t,this.authService=n,this.restService=o,this.formService=s,this.globalService=a,this.storageService=l,this.formGroupTemplate=h,this.formError={email:{label:"t_email",msg:""},password:{label:"t_password",msg:""}},this.isSubmitted=!1,this.errorMsg="",this.passwordType="password",this.isSendingForm=!1}ngOnInit(){}ionViewWillEnter(){return(0,p.Z)(function*(){})()}togglePasswordType(){this.passwordType="password"!==this.passwordType?"password":"text"}submit(){var e=this;return(0,p.Z)(function*(){e.navigationService.toDashboardPage()})()}validateForm(){if(this.formService.resetErrors(this.formError),this.formGroupTemplate.loginForm.valid)return!0;this.formService.validateForm(this.formGroupTemplate.loginForm,this.formError);const e=this.formService.getFirstError(this.formError);return this.globalService.showToast(e,"danger"),!1}setUserSession(e,t){var n=this;return(0,p.Z)(function*(){try{var o;if(yield n.authService.setSession(e,t.token,t.expired_at),yield n.getAddress(),!(null===(o=n.authService.isAuthenticated$)||void 0===o?void 0:o.getValue()))return;n.navigationService.toDashboardPage()}catch(s){n.globalService.errorHandler(s,"-- Gagal membuat sesi --")}})()}getAddress(){return(0,p.Z)(function*(){})()}changeLanguage(e){var t;(null!==(t=this.storageService.language)&&void 0!==t?t:"id")===e||!this.formService.getFirstError(this.formError)||this.formService.validateForm(this.formGroupTemplate.loginForm,this.formError)}}return r.\u0275fac=function(e){return new(e||r)(i.Y36(x.f),i.Y36(g.qu),i.Y36(P.e),i.Y36(z),i.Y36(B),i.Y36(E.U),i.Y36(j.V),i.Y36(Q))},r.\u0275cmp=i.Xpm({type:r,selectors:[["app-login"]],decls:20,vars:4,consts:[[1,"bg-white"],[1,"bg-white","h-100","w-100"],["src","assets/icon/ax_logo.png",1,"absolute-bottom","ml-3","mt-3",2,"position","absolute"],[1,"form-login","h-100"],[1,"pt-4","pl-5","bg-transparent",2,"margin-top","10%"],[1,"form-input","ml-5","mt-5","w-50","ml-auto","mr-auto"],[1,"bold-text","h7","mb-1"],[1,"text-grey"],[3,"formGroup"],["placeholder","Masukkan Email","type","email","formControlName","email",3,"required"],[1,"mt-3"],["placeholder","Masukkan Password","type","password","formControlName","password",3,"required"],[4,"ngIf"],["color","red","type","submit",1,"mt-3",2,"width","99%",3,"click"],[1,"p-0"],["src","assets/img/kimetsu.jpg",1,"gambar-login"]],template:function(e,t){1&e&&(i.TgZ(0,"ion-content",0)(1,"div",1),i._UZ(2,"img",2),i.TgZ(3,"section",3)(4,"ion-row")(5,"ion-col",4)(6,"div",5)(7,"p",6),i._uU(8," Masuk "),i.qZA(),i.TgZ(9,"p",7),i._uU(10," Isi Username dan Password untuk mengakses Internal System Astral Express Manifest Studio "),i.qZA(),i.TgZ(11,"form",8),i._UZ(12,"app-input-form",9),i.TgZ(13,"div",10),i._UZ(14,"app-input-form",11),i.qZA(),i.YNc(15,K,2,1,"p",12),i.TgZ(16,"ion-button",13),i.NdJ("click",function(){return t.submit()}),i._uU(17,"Masuk"),i.qZA()()()(),i.TgZ(18,"ion-col",14),i._UZ(19,"img",15),i.qZA()()()()()),2&e&&(i.xp6(11),i.Q6J("formGroup",t.formGroupTemplate.loginForm),i.xp6(1),i.Q6J("required",!0),i.xp6(2),i.Q6J("required",!0),i.xp6(1),i.Q6J("ngIf",t.errorMsg))},dependencies:[L.O5,g._Y,g.JJ,g.JL,g.Q7,b.YG,b.wI,b.W2,b.Nd,g.sg,g.u,V.E],styles:[".gambar-login[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:fill}"]}),r})()}];let X=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=i.oAB({type:r}),r.\u0275inj=i.cJS({imports:[w.Bz.forChild(W),w.Bz]}),r})();var q=c(4636);let k=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=i.oAB({type:r}),r.\u0275inj=i.cJS({imports:[L.ez,g.u5,b.Pc,X,g.UX,q.K]}),r})()}}]);